import{f as $,r as k,j as e,m as d,B as p}from"./index-CTDs4bRA.js";import{C as H,I as J}from"./game.multiplayer-CQKVkTsd.js";import{f as q,C as h,I as K}from"./Home-j1PCE9Cf.js";import{R as L}from"./rotate-ccw-BBSprXgg.js";function U(){const{isHost:g,startGame:S,localPlayerId:r,gameState:c,changeGame:u,players:l,setPlayers:m}=$(),{currentCardIndex:n=0,phase:E,shuffledCards:f=[],step:y,winner:G}=c??{},[b,P]=k.useState(""),[j,R]=k.useState(null),z=q.themes.flatMap(t=>t.items);function M(){return[...z].sort(()=>Math.random()-.5)}const o=f[n],v=()=>{const t=l.map(i=>(i.metadata={response:{playerId:i.id},voted:!1,submited:!1},i.points=0,i));S({phase:"playing",step:"question",currentCardIndex:0,shuffledCards:M()}),m(t)},_=()=>{u({...c,step:"writing"})},N=()=>{const t=l.map(a=>(a.metadata.submited=a.id==r?!0:a.metadata.submited,a.metadata.response.text=a.id==r?b:a.metadata.response.text,a));m(t),t.every(a=>a?.metadata?.submited)&&u({...c,step:"voting"})},D=()=>{const t=l.map(a=>(a.metadata.voted=a.id==r?!0:a.metadata.voted,a.metadata.voteId=a.id==r?j:a.metadata.voteId,a)),i=t.every(a=>a?.metadata?.voted);if(m(t),i){const a=l?.map(s=>({...s?.metadata?.response})),x={};t.forEach(s=>{s.metadata.voted&&s.metadata.voteId&&(x[s.metadata.voteId]=(x[s.metadata.voteId]||0)+1)});const B=Object.keys(x).reduce((s,I)=>x[s]>x[I]?s:I,null),C=a.find(s=>s.playerId==B);m(l.map(s=>({...s,points:C.playerId==s.id?s.points+1:s.points}))),u({...c,step:"results",winner:C})}},F=()=>{if(n<f.length-1){const t=l.map(i=>(i.metadata={response:{playerId:i.id},voted:!1,submited:!1},i));m(t),u({...c,currentCardIndex:n+1,step:"question"})}},V=()=>{v()},w=l?.find(t=>t.id==r),A=l?.map(t=>t?.metadata?.response);return e.jsx(H,{className:"text-gradient-poderes",game:q,icon:e.jsx(J,{variant:"poderes"}),onStart:v,showMultiplayer:!0,children:E=="playing"&&e.jsxs(d.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-card rounded-2xl border border-border overflow-hidden p-5",children:[y=="question"&&e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsxs("span",{className:"text-onca text-sm font-medium",children:["Carta ",n+1," de ",f.length]})}),e.jsx(d.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-poderes mb-8 max-w-md",children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:o.title})}),e.jsxs(p,{onClick:_,variant:"poderes",size:"lg",disabled:!g,children:["Começar",e.jsx(h,{className:"w-5 h-5 ml-2"})]})]},"question"),y=="writing"&&e.jsx(e.Fragment,{children:e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsxs("span",{className:"text-onca text-sm font-medium",children:["Carta ",n+1," de ",f.length]})}),e.jsx(d.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-poderes mb-8 max-w-md",children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:o.title})}),e.jsx("div",{className:"w-full m-4",children:e.jsxs("div",{className:"glass-card p-4 rounded-xl space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"font-medium",children:"Destrua o poder"})}),e.jsx("div",{className:"flex gap-2",children:e.jsx(K,{value:b,onChange:t=>P(t.target.value),onKeyDown:t=>t.key==="Enter"&&N(),className:"flex-1",maxLength:100})})]})}),e.jsxs(p,{onClick:N,variant:"poderes",size:"lg",disabled:w?.metadata?.submited,children:["Enviar",e.jsx(h,{className:"w-5 h-5 ml-2"})]})]},"question")}),y=="voting"&&e.jsx(e.Fragment,{children:e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsxs(d.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-poderes mb-8 max-w-md",children:[e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:o.title}),e.jsx("p",{className:"text-muted-foreground text-md",children:o.footer}),e.jsx("p",{className:"text-muted-foreground text-sm italic font-bold",children:"Ass: Nelson, o pombo da discórdia"})]}),e.jsx("div",{className:"text-center mb-8",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"Escolha"})}),e.jsx("div",{className:"grid  grid-cols-1 lg:grid-cols-3 xl:grid-cols-4 md:grid-cols-2 gap-3",children:A?.map(t=>e.jsx(d.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:`bg-card/10 backdrop-blur border rounded-3xl p-8 ${t?.playerId==j?"shadow-glow-onca":""}  mb-2 max-w-md`,onClick:()=>{R(t.playerId)},children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:t.text})}))}),e.jsxs(p,{onClick:D,variant:"poderes",size:"lg",disabled:w?.metadata?.voted,children:["Votar",e.jsx(h,{className:"w-5 h-5 ml-2"})]})]},"question")}),y=="results"&&e.jsx(e.Fragment,{children:e.jsxs(d.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsxs(d.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-poderes mb-8 max-w-md",children:[e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:o.title}),e.jsx("p",{className:"text-muted-foreground text-md",children:o.footer}),e.jsx("p",{className:"text-muted-foreground text-sm italic font-bold",children:"Ass: Nelson, o pombo da discórdia"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(d.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/10 backdrop-blur border rounded-3xl p-8 shadow-glow-onca  mb-2 max-w-md",children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:G?.text})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(p,{onClick:F,variant:"decisoes",size:"lg",className:"w-full",disabled:!g,children:["Próxima Rodada",e.jsx(h,{className:"w-5 h-5 ml-2"})]}),e.jsxs(p,{onClick:V,variant:"outline",size:"lg",className:"w-full",disabled:!g,children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Novo Jogo"]})]})]},"question")})]},`poderes-${n}`)})}export{U as Poderes,U as default};
