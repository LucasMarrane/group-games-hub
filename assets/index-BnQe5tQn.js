import{c as C,r as v,f as U,j as e,m as h,A as H,B as d,t as L}from"./index-CTDs4bRA.js";import{b as R,B as _,I as O,C as T}from"./Home-j1PCE9Cf.js";import{C as J,E as G,P as K,I as W}from"./game.multiplayer-CQKVkTsd.js";import{R as X}from"./rotate-ccw-BBSprXgg.js";const Y=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],Z=C("flag",Y);const ee=[["path",{d:"M5 12h14",key:"1ays0h"}]],se=C("minus",ee);const ae=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],te=C("send",ae);function ce(){const[p,N]=v.useState(0),{isHost:w,startGame:M,localPlayerId:r,gameState:c,changeGame:u,mode:b,setPlayers:f,players:n}=U(),{showAnswer:k=!1,shuffledCards:z=[],currentCardIndex:j=0,minValue:x=0,lastPlayer:E,actualPlayer:g}=c??{},P=R.themes.flatMap(s=>s.items.map(i=>({...i,theme:i.title,value:i.value,answer:i.answer,category:s.categories.find(a=>a.id==i.category)?.name}))),o=z[j];function F(){return[...P].sort(()=>Math.random()-.5)}const A=v.useCallback(()=>{w&&n.every(s=>s.name.trim())&&(M("playing"),m())},[n]),y=v.useRef(r);function m(s="shuffle"){({shuffle:()=>{const a=F();f(n.map(t=>({...t,points:0}))),u({...c,phase:"playing",showAnswer:!1,currentCardIndex:0,shuffledCards:a,actualPlayer:r,minValue:0})},addValue:()=>{const a=n.map(t=>{let l={...t};return t.id==y.current&&(l.points=t.points+o.value),l});f(a)},removeValue:()=>{const a=n.map(t=>{let l={...t};return t.id==y.current&&(l.points=t.points-o.value),l});f(a)},nextQuestion:()=>{const a=j>=P.length-1?0:j+1;u({...c,currentCardIndex:a,showAnswer:!1})},showAnswer:()=>{let a=n;if(!["single","local"].includes(b)){const t=x>o.answer?E:r;a=n.map(l=>{let I={...l};return l.id==t&&(I.points=l.points+o.value),I})}f(a),u({...c,showAnswer:!0,minValue:0})},guess:()=>{const a=n.findIndex(l=>l.id==r),t=a>=n.length-1?0:a+1;u({...c,minValue:p,lastPlayer:r,actualPlayer:n[t].id})},finish:()=>{u({...c,phase:"finished"})}})?.[s]?.()}function S(){m("addValue")}function $(){m("removeValue")}function V(){m("showAnswer")}function B(){if(p<=x){L.warning("Apenas valor maior que o valor anterior é permitido");return}m("guess")}const D=()=>{m("nextQuestion")},q=()=>{A()},Q=()=>{m("finish")};return v.useEffect(()=>{N(x)},[x]),e.jsxs(J,{game:R,className:"text-gradient-palpiteiro",icon:e.jsx(W,{variant:"palpiteiro"}),onStart:A,showMultiplayer:!0,children:[c?.phase==="playing"&&o&&e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex-1 flex flex-col gap-4",children:[e.jsxs(h.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-card rounded-2xl border border-border overflow-hidden",children:[e.jsx("div",{className:"gradient-palpiteiro p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-display font-bold text-white",children:o.category}),e.jsxs("div",{className:"flex items-center gap-1 bg-white/20 px-3 py-1 rounded-full",children:[e.jsx(_,{className:"w-4 h-4 text-white"}),e.jsx("span",{className:"text-white font-bold",children:o.value})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-xl font-display text-foreground text-center mb-6",children:o.theme}),e.jsx("div",{className:"bg-muted rounded-xl p-4",children:e.jsx(H,{mode:"wait",children:k?e.jsx(h.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},className:"text-center",children:e.jsx("span",{className:"text-5xl font-display font-bold text-gradient-palpiteiro",children:o.answer})},"answer"):e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:" flex text-center justify-around md:flex-row flex-col",children:b=="online"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-center align-center mb-2 sm:mb-0",children:[e.jsx(O,{placeholder:"Valor",type:"number",value:p,min:x+1,disabled:r!=g,onChange:s=>{const i=s?.target?.value??"0";if(!i){N(s?.target?.value);return}/^\d+$/.test(i)&&N(Number(i))},className:"text-center"}),e.jsxs(d,{variant:"palpiteiro",size:"default",onClick:B,className:"gap-2 ml-5",disabled:r!=g,children:[e.jsx(te,{className:"w-5 h-5"}),"Responder"]})]}),e.jsx("div",{children:e.jsxs(d,{variant:"palpiteiro",size:"lg",onClick:()=>V(),className:"gap-2",disabled:r!=g||!p,children:[e.jsx(G,{className:"w-5 h-5"}),"EU DUVIDO ....."]})})]}):e.jsx(e.Fragment,{children:e.jsxs(d,{variant:"palpiteiro",size:"lg",onClick:V,className:"gap-2",children:[e.jsx(G,{className:"w-5 h-5"}),"Revelar Resposta"]})})},"hidden")})})]})]},`palpiteiro-${j}`),b=="local"&&k&&e.jsx(e.Fragment,{children:e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card rounded-2xl p-4 border border-border",children:[e.jsxs("h4",{className:"text-sm text-muted-foreground mb-3 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Distribuir pontuação"]}),e.jsx("div",{className:"space-y-2",children:n.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between bg-muted rounded-lg p-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>{y.current=s.id,$()},className:"h-8 w-8",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-8 text-center font-bold",children:s.points}),e.jsx(d,{variant:"palpiteiro",size:"icon",onClick:()=>{y.current=s.id,S()},className:"h-8 w-8",children:e.jsx(K,{className:"w-4 h-4"})})]})]},`pontuacao-${s.id??i}`))})]},"local-values")})]},"counter"),["playing","finished"].includes(c?.phase)&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"glass",className:"flex-1",disabled:!w,onClick:q,children:[e.jsx(X,{className:"w-4 h-4"}),"Reiniciar"]}),c?.phase!="finished"&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{variant:"destructive",className:"flex-1",onClick:Q,disabled:!w,children:[e.jsx(Z,{className:"w-4 h-4"}),"Finalizar"]}),e.jsxs(d,{variant:"palpiteiro",className:"flex-1",onClick:D,disabled:g!=r,children:[e.jsx(T,{className:"w-4 h-4"}),"Próxima"]})]})]})]})}export{ce as Palpiteiro,ce as default};
