import{f as H,r as S,j as e,m as i,B as u}from"./index-CTDs4bRA.js";import{C as J,I as O}from"./game.multiplayer-CQKVkTsd.js";import{e as j,C as y}from"./Home-j1PCE9Cf.js";import{R as Q}from"./rotate-ccw-BBSprXgg.js";function X(){const{isHost:g,startGame:E,localPlayerId:n,gameState:m,changeGame:p,players:l,setPlayers:x}=H(),{currentCardIndex:o=0,phase:G,shuffledCards:f=[],step:h,winner:N}=m??{},[v,R]=S.useState(null),[w,z]=S.useState(null),B=j.blackCards,M=j.whiteCards;function P(){return[...B].sort(()=>Math.random()-.5)}function C(){return[...M].sort(()=>Math.random()-.5)}const c=f[o],q=()=>{const a=C(),r=l.map((t,d)=>(t.metadata={cards:a.splice(d*5,5),voted:!1,submited:!1},t.points=0,t));E({phase:"playing",step:"question",currentCardIndex:0,shuffledCards:P()}),x(r)},_=()=>{p({...m,step:"writing"})},A=()=>{const a=l.map(t=>(t.metadata.submited=t.id==n?!0:t.metadata.submited,t.metadata.selected=t.id==n?v:t.metadata.selected,t));x(a),a.every(t=>t?.metadata?.submited)&&p({...m,step:"voting"})},F=()=>{const a=l.map(t=>(t.metadata.voted=t.id==n?!0:t.metadata.voted,t.metadata.voteId=t.id==n?w:t.metadata.voteId,t)),r=a.every(t=>t?.metadata?.voted);if(x(a),r){const t=l?.map(s=>({...s?.metadata?.selected,playerId:s.id})),d={};a.forEach(s=>{s.metadata.voted&&s.metadata.voteId&&(d[s.metadata.voteId]=(d[s.metadata.voteId]||0)+1)});const D=Object.keys(d).reduce((s,I)=>d[s]>d[I]?s:I,null),k=t.find(s=>s.id==D);x(l.map(s=>({...s,points:k.playerId==s.id?s.points+1:s.points}))),p({...m,step:"results",winner:k})}},V=()=>{if(o<f.length-1){const a=C(),r=l.map((t,d)=>(t.metadata={cards:a.splice(d*5,5),voted:!1,submited:!1},t));x(r),p({...m,currentCardIndex:o+1,step:"question"})}},W=()=>{q()},b=l?.find(a=>a.id==n),$=l?.map(a=>a?.metadata?.selected);return e.jsx(J,{className:"text-gradient-caotiqueira",game:j,icon:e.jsx(O,{variant:"caotiqueira"}),onStart:q,showMultiplayer:!0,children:G=="playing"&&e.jsxs(i.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-card rounded-2xl border border-border overflow-hidden p-5",children:[h=="question"&&e.jsxs(i.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsxs("span",{className:"text-onca text-sm font-medium",children:["Carta ",o+1," de ",f.length]})}),e.jsx(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-caotiqueira mb-8 max-w-md",children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:c.title})}),e.jsxs(u,{onClick:_,variant:"caotiqueira",size:"lg",disabled:!g,children:["Começar",e.jsx(y,{className:"w-5 h-5 ml-2"})]})]},"question"),h=="writing"&&e.jsx(e.Fragment,{children:e.jsxs(i.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"text-center mb-8",children:e.jsxs("span",{className:"text-onca text-sm font-medium",children:["Carta ",o+1," de ",f.length]})}),e.jsx(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-caotiqueira mb-8 max-w-md",children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:c.title})}),e.jsx("div",{className:"text-center mb-8",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"Escolha"})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-4 md:grid-cols-2 gap-3",children:b?.metadata?.cards?.map(a=>e.jsx(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:`bg-card/10 backdrop-blur border rounded-3xl p-8 ${a.id==v?.id?"shadow-glow-onca":""}  mb-2 max-w-md`,onClick:()=>{R(a)},children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:a.title})}))}),e.jsxs(u,{onClick:A,variant:"caotiqueira",size:"lg",disabled:b?.metadata?.submited,children:["Escolher carta",e.jsx(y,{className:"w-5 h-5 ml-2"})]})]},"question")}),h=="voting"&&e.jsx(e.Fragment,{children:e.jsxs(i.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsxs(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-caotiqueira mb-8 max-w-md",children:[e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:c.title}),e.jsx("p",{className:"text-muted-foreground text-md",children:c.footer}),e.jsx("p",{className:"text-muted-foreground text-sm italic font-bold",children:"Ass: Nelson, o pombo da discórdia"})]}),e.jsx("div",{className:"text-center mb-8",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"Escolha"})}),e.jsx("div",{className:"grid  grid-cols-1 lg:grid-cols-3 xl:grid-cols-4 md:grid-cols-2 gap-3",children:$?.map(a=>e.jsx(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:`bg-card/10 backdrop-blur border rounded-3xl p-8 ${a?.id==w?"shadow-glow-onca":""}  mb-2 max-w-md`,onClick:()=>{z(a.id)},children:e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:a.title})}))}),e.jsxs(u,{onClick:F,variant:"caotiqueira",size:"lg",disabled:b?.metadata?.voted,children:["Votar",e.jsx(y,{className:"w-5 h-5 ml-2"})]})]},"question")}),h=="results"&&e.jsx(e.Fragment,{children:e.jsxs(i.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col items-center justify-center",children:[e.jsxs(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/80 backdrop-blur rounded-3xl p-8 shadow-glow-caotiqueira mb-8 max-w-md",children:[e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:c.title}),e.jsx("p",{className:"text-muted-foreground text-md",children:c.footer}),e.jsx("p",{className:"text-muted-foreground text-sm italic font-bold",children:"Ass: Nelson, o pombo da discórdia"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-4 md:grid-cols-2",children:e.jsxs(i.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"bg-card/10 backdrop-blur border rounded-3xl p-8 shadow-glow-onca  mb-2 max-w-md",children:[e.jsx("p",{className:"text-xl font-display font-semibold text-foreground text-center",children:N?.title}),e.jsx("p",{className:"text-muted-foreground text-md",children:N.footer}),e.jsx("p",{className:"text-muted-foreground text-sm italic font-bold",children:"Ass: Nelson, o pombo da discórdia"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(u,{onClick:V,variant:"decisoes",size:"lg",className:"w-full",disabled:!g,children:["Próxima Rodada",e.jsx(y,{className:"w-5 h-5 ml-2"})]}),e.jsxs(u,{onClick:W,variant:"outline",size:"lg",className:"w-full",disabled:!g,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Novo Jogo"]})]})]},"question")})]},`caotiqueira-${o}`)})}export{X as Caotiqueira,X as default};
